import{e as b,i as q,m as A,r as p,f as E,w as c,n as h,o as i,k as g,b as v,g as e,aa as R,c as w,t as u,a as k}from"./3s1sx6wo.js";import{u as B,s as m}from"./DVVigWha.js";import{u as N,a as $}from"./BBNxizPQ.js";import{_ as L}from"./DM8KnH0J.js";import{V as I}from"./BrZF6G-H.js";import{V as T,a as z}from"./BJXrktLP.js";import{w as D}from"./C9R-QpZI.js";import"./JhrxTPuU.js";import"./CVQlkizh.js";import"./B5CZD0j7.js";import"./BFI1zpWj.js";import"./D6KsYbGk.js";import"./BMdyi6GD.js";const M={key:0,class:"my-2"},j={key:1,class:"my-2"},F={key:2,class:"my-2"},G={class:"my-2"},H={class:"my-2"},le=b({__name:"[method]",setup(J){const S=q(),d=A(),r=p(0),t=p(!1),l=p(!1),{getState:U}=B(),o=U(d.query.state.toString(),!0),C=p(""),x=()=>{h(o.RedirectUri,{external:!0})},P=async()=>{const n=await $(o,C.value);if(n){const a=new URL(n).searchParams.get("error");a?a=="access_denied"&&(t.value=!0,r.value=3):h(n,{external:!0})}else t.value=!0,r.value=2};return o?(async()=>{if(!d.query.code){t.value=!0,r.value=2;return}const n=d.query.code.toString(),s=`${window.location.origin}${S.resolve("/connect/external").href}/keycloak`,{CreateToken:a,RedirectURI:y}=await N(o,n,s,d.params.method.toString(),!1);if(a&&(C.value=a),y){const V=new URL(y),f=V.searchParams.get("error");if(f)f=="access_denied"?l.value=!0:f=="invalid_request"?(t.value=!0,r.value=1):f=="server_error"&&(t.value=!0,r.value=2);else{const _=new URL(o.RedirectUri);_.searchParams.set("state",o.State),_.searchParams.set("code",V.searchParams.get("code")||""),h(_.toString(),{external:!0})}}else t.value=!0,r.value=2})():(t.value=!0,r.value=2),(n,s)=>(i(),E(I,{class:"h-100"},{default:c(()=>[!e(l)&&!e(t)?(i(),E(T,{key:0,class:"h-100"},{default:c(()=>[v(z,{class:"text-center align-content-center"},{default:c(()=>[v(D,{color:"primary",size:110,width:12,indeterminate:""})]),_:1})]),_:1})):g("",!0),v(L,{modelValue:e(t),"onUpdate:modelValue":s[0]||(s[0]=a=>R(t)?t.value=a:null),"show-save-action":!1,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Error Attempting Login","hide-extension":!0,"remove-button-spacer":!0,"close-action-label":"Close",onClose:x},{default:c(()=>[e(r)===1?(i(),w("p",M,u(e(m).messageCreateExternalError1),1)):g("",!0),e(r)===2?(i(),w("p",j,u(e(m).messageCreateExternalError2),1)):g("",!0),e(r)===3?(i(),w("p",F,u(e(m).messageCreateExternalError3),1)):g("",!0)]),_:1},8,["modelValue"]),v(L,{modelValue:e(l),"onUpdate:modelValue":s[1]||(s[1]=a=>R(l)?l.value=a:null),"show-save-action":!0,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Create new account","hide-extension":!0,"save-button-label":"Create Account",persistent:!0,"retain-focus":!0,onSave:P,onClose:x},{default:c(()=>[k("p",G,u(e(m).messageCreateExternalAccount1),1),k("p",H,u(e(m).messageCreateExternalAccount2),1)]),_:1},8,["modelValue"])]),_:1}))}});export{le as default};
