import{e as K,r as v,ae as ce,R as de,B as we,f as V,c as F,k as S,o as y,U as J,g as i,ac as me,h as z,w as s,b as u,d as B,t as N,F as ae,a as C,_ as H,P as pe,M as ye,a2 as he,a1 as ke,G as W,af as Re,Z as Te,$ as G,l as X,a8 as Ae,V as Ce,a0 as se,ag as Ee,ah as Le,ai as xe,a9 as Ie,aj as le,n as Y,q as Ve,a3 as $e,a4 as De,ab as oe}from"./DBeo1IW4.js";import{s as A}from"./CvSZD4Vs.js";import{d as fe,e as re,u as Be,a as Oe,f as Se,m as Ne}from"./De8j9Ja5.js";import{V as P,a as U}from"./BSr-QuFa.js";import{V as j,x as qe,y as Ue}from"./HAnE_YmP.js";import{l as Me,_ as ue}from"./DJ8cwUYa.js";import{b as Pe,u as Fe,c as je}from"./CkIa2Ul0.js";import{u as Ge}from"./Dwcg0_5Q.js";import{u as ve}from"./Uwvz5ONY.js";import{u as te}from"./DxeCKos8.js";import{V as ze,a as _e}from"./DIKAqNE9.js";var O=(e=>(e.ADD_CREDENTIAL="ADD_CREDENTIAL",e.COMBINED="COMBINED",e.LOGIN="LOGIN",e.REGISTER="REGISTER",e))(O||{});const Je={key:1,class:"ma-auto text-left"},Ke={key:2,class:"ma-auto text-left"},Ze={key:3,class:"ma-auto text-left"},We={class:"text-red-darken-1 font-weight-bold"},Ye={class:"text-center mt-4"},He=K({__name:"EmailLoginForm",props:{disabled:{type:Boolean,default:!1},requirePassword:{type:Boolean,default:!0},theme:{default:""},variant:{default:()=>O.COMBINED}},emits:["callback"],setup(e,{emit:w}){const g=v(!0);ce();const b=z(),l=w,{smAndUp:m}=de(),c=v(!1),t=v(!1),d=v(!1),a=v(""),L=v(""),$=v(!1),x=v({passwordRequired:R=>!e.requirePassword||!!R||"Required.",required:R=>!!R||"Required.",min:R=>!e.requirePassword||R.length>=8||"Min 8 characters",email:R=>!!R.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)||"Valid email address required"}),h=v(""),k=()=>(h.value="",!(x.value.required(a.value)!==!0||x.value.email(a.value)!==!0||x.value.passwordRequired(L.value)!==!0||x.value.min(L.value)!==!0)),p=(R=>{switch(R.preventDefault(),R.submitter.value){case"add":f();break;case"create":D();break;case"forgot":M();break;case"login":default:n();break}}),n=(()=>{if(!k()){console.log("invalid");return}l("callback",{mode:"login",username:a.value,password:L.value})}),f=((R=void 0)=>{R&&R.preventDefault(),k()&&l("callback",{mode:"add",username:a.value,password:L.value})}),D=((R=void 0)=>{R&&R.preventDefault(),k()&&l("callback",{mode:"create",username:a.value,password:L.value})}),M=(()=>{(h.value="",!(x.value.required(a.value)!==!0||x.value.email(a.value)!==!0))&&l("callback",{mode:"link",username:a.value,password:L.value})});return(R,o)=>{const Q=we("router-link");return g.value?(y(),V(fe,{key:0,onSubmit:me(p,["stop"]),disabled:e.disabled,id:"login-form",action:`${i(b).public.issuerUri}/connect/auth/internal`,method:"post",class:J(`pa-4 rounded rounded-l ${e.theme?`theme-${e.theme}`:""}`)},{default:s(()=>[u(P,null,{default:s(()=>[u(U,null,{default:s(()=>[u(re,{margin:"normal",required:"",id:"username",label:"Email Address",name:"username",autocomplete:"username",autofocus:"",variant:"outlined",modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=_=>a.value=_),rules:[x.value.required,x.value.email],clearable:!0},null,8,["modelValue","rules"])]),_:1})]),_:1}),e.requirePassword?(y(),V(P,{key:0},{default:s(()=>[u(U,null,{default:s(()=>[u(re,{margin:"normal",required:"",name:"password",label:"Password",type:$.value?"text":"password",id:"password",autocomplete:"current-password",variant:"outlined",modelValue:L.value,"onUpdate:modelValue":o[1]||(o[1]=_=>L.value=_),"append-inner-icon":$.value?"mdi:mdi-eye-off":"mdi:mdi-eye","onClick:appendInner":o[2]||(o[2]=_=>$.value=!$.value),counter:"",hint:"At least 8 characters",rules:[x.value.required,x.value.min],clearable:!1},null,8,["type","modelValue","append-inner-icon","rules"])]),_:1})]),_:1})):S("",!0),h.value?(y(),V(P,{key:1},{default:s(()=>[u(U,{class:"text-red-darken-1 font-weight-bold"},{default:s(()=>[B(N(h.value),1)]),_:1})]),_:1})):S("",!0),u(P,{justify:"space-between"},{default:s(()=>[e.variant===i(O).COMBINED||e.variant===i(O).REGISTER?(y(),V(U,{key:0,cols:"12",sm:"7",order:"2","order-sm":"1",class:J(`${i(m)?"":"text-center"}`)},{default:s(()=>[u(j,{color:"orange-darken-2",disabled:e.disabled,type:e.variant===i(O).COMBINED?"button":"submit",class:"w-100","prepend-icon":"mdi:mdi-account-edit",onClick:D,value:"create"},{default:s(()=>[...o[3]||(o[3]=[B(" Create Account ",-1)])]),_:1},8,["disabled","type"])]),_:1},8,["class"])):S("",!0),e.variant===i(O).COMBINED||e.variant===i(O).LOGIN?(y(),V(U,{key:1,cols:"12",sm:"5",order:"1","order-sm":"2",class:J(`${i(m)?"text-right":"text-center"}`)},{default:s(()=>[u(j,{color:"success",disabled:e.disabled,type:"submit",class:"w-100","prepend-icon":"mdi:mdi-login",value:"login"},{default:s(()=>[...o[4]||(o[4]=[B(" Sign In ",-1)])]),_:1},8,["disabled"])]),_:1},8,["class"])):S("",!0),e.variant===i(O).ADD_CREDENTIAL?(y(),V(U,{key:2,cols:"12",class:"flex-grow-0 text-right"},{default:s(()=>[u(j,{color:"success",disabled:e.disabled,type:"submit",value:"add"},{default:s(()=>[...o[5]||(o[5]=[B(" Add Email ",-1)])]),_:1},8,["disabled"])]),_:1})):S("",!0)]),_:1}),e.variant===i(O).COMBINED||e.variant===i(O).LOGIN?(y(),V(P,{key:2},{default:s(()=>[u(U,null,{default:s(()=>[u(j,{type:"submit",class:"w-100",color:"grey",disabled:e.disabled,"prepend-icon":"mdi:mdi-account-question",value:"forgot"},{default:s(()=>[B(N(i(A).buttonForgottenPassword),1)]),_:1},8,["disabled"])]),_:1})]),_:1})):S("",!0)]),_:1},8,["disabled","action","class"])):c.value?(y(),F("p",Je,N(i(A).messageResetEmail),1)):t.value?(y(),F("p",Ke,N(i(A).messageVerifyNewAccountEmail),1)):d.value?(y(),F("p",Ze,[B(N(i(A).messageVerifiedNewAccountMessage)+" ",1),h.value?(y(),F(ae,{key:0},[o[9]||(o[9]=C("br",null,null,-1)),o[10]||(o[10]=C("br",null,null,-1)),C("span",We,[o[6]||(o[6]=B(" An error occurred creating or recovering account:",-1)),o[7]||(o[7]=C("br",null,null,-1)),B(" "+N(h.value),1)]),o[11]||(o[11]=C("br",null,null,-1)),o[12]||(o[12]=C("br",null,null,-1)),o[13]||(o[13]=C("span",{class:"text-red-darken-4"}," Please contact registration if you require further assistance. ",-1)),C("div",Ye,[u(Q,{to:"/"},{default:s(()=>[u(j,{color:"red"},{default:s(()=>[...o[8]||(o[8]=[B("Close",-1)])]),_:1})]),_:1})])],64)):S("",!0)])):S("",!0)}}}),Qe=H(He,[["__scopeId","data-v-8b72eb5c"]]),Xe=ye({autofocus:Boolean,divider:String,focusAll:Boolean,label:{type:String,default:"$vuetify.input.otp"},length:{type:[Number,String],default:6},modelValue:{type:[Number,String],default:void 0},placeholder:String,type:{type:String,default:"number"},...je(),...Se(),...Ee(Ne({variant:"outlined"}),["baseColor","bgColor","class","color","disabled","error","loading","rounded","style","theme","variant"])},"VOtpInput"),ea=pe()({name:"VOtpInput",props:Xe(),emits:{finish:e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,w){let{attrs:g,emit:b,slots:l}=w;const{dimensionStyles:m}=Pe(e),{isFocused:c,focus:t,blur:d}=Be(e),a=he(e,"modelValue","",r=>r==null?[]:String(r).split(""),r=>r.join("")),{t:L}=ke(),$=W(()=>Number(e.length)),x=W(()=>Array($.value).fill(0)),h=v(-1),k=v(),p=v([]),n=W(()=>p.value[h.value]);let f=!1;Re(()=>e.autofocus,()=>{const r=Le();r.run(()=>{const{intersectionRef:T,isIntersecting:I}=qe();xe(()=>{T.value=p.value[0]}),X(I,q=>{var E;q&&((E=T.value)==null||E.focus(),r.stop())})})});function D(){if(ne(n.value.value)){n.value.value="";return}if(f)return;const r=a.value.slice(),T=n.value.value;r[h.value]=T;let I=null;h.value>a.value.length?I=a.value.length+1:h.value+1!==$.value&&(I="next"),a.value=r,I&&le(k.value,I)}function M(){f=!1,D()}function R(r){const T=a.value.slice(),I=h.value;let q=null;["ArrowLeft","ArrowRight","Backspace","Delete"].includes(r.key)&&(r.preventDefault(),r.key==="ArrowLeft"?q="prev":r.key==="ArrowRight"?q="next":["Backspace","Delete"].includes(r.key)&&(T[h.value]="",a.value=T,h.value>0&&r.key==="Backspace"?q="prev":requestAnimationFrame(()=>{var E;(E=p.value[I])==null||E.select()})),requestAnimationFrame(()=>{q!=null&&le(k.value,q)}))}function o(r,T){var E;T.preventDefault(),T.stopPropagation();const I=((E=T==null?void 0:T.clipboardData)==null?void 0:E.getData("Text").trim().slice(0,$.value))??"",q=I.length-1===-1?r:I.length-1;ne(I)||(a.value=I.split(""),h.value=q)}function Q(){a.value=[]}function _(r,T){t(),h.value=T}function be(){d(),h.value=-1}function ne(r){return e.type==="number"&&/[^0-9]/g.test(r)}return Te({VField:{color:G(()=>e.color),bgColor:G(()=>e.color),baseColor:G(()=>e.baseColor),disabled:G(()=>e.disabled),error:G(()=>e.error),variant:G(()=>e.variant),rounded:G(()=>e.rounded)}},{scoped:!0}),X(a,r=>{r.length===$.value&&b("finish",r.join(""))},{deep:!0}),X(h,r=>{r<0||Ie(()=>{var T;(T=p.value[r])==null||T.select()})}),Fe(()=>{var I;const[r,T]=Ae(g);return C("div",se({class:["v-otp-input",{"v-otp-input--divided":!!e.divider},e.class],style:[e.style]},r),[C("div",{ref:k,class:"v-otp-input__content",style:Ce([m.value])},[x.value.map((q,E)=>C(ae,null,[e.divider&&E!==0&&C("span",{class:"v-otp-input__divider"},[e.divider]),u(Oe,{focused:c.value&&e.focusAll||h.value===E,key:E},{...l,loader:void 0,default:()=>C("input",{ref:Z=>p.value[E]=Z,"aria-label":L(e.label,E+1),autofocus:E===0&&e.autofocus,autocomplete:"one-time-code",class:J(["v-otp-input__field"]),disabled:e.disabled,inputmode:e.type==="number"?"numeric":"text",min:e.type==="number"?0:void 0,maxlength:E===0?$.value:"1",placeholder:e.placeholder,type:e.type==="number"?"text":e.type,value:a.value[E],onInput:D,onFocus:Z=>_(Z,E),onBlur:be,onKeydown:R,onCompositionstart:()=>f=!0,onCompositionend:M,onPaste:Z=>o(E,Z)},null)})])),C("input",se({class:"v-otp-input-input",type:"hidden"},T,{value:a.value.join("")}),null),u(Me,{contained:!0,contentClass:"v-otp-input__loader",modelValue:!!e.loading,persistent:!0},{default:()=>{var q;return[((q=l.loader)==null?void 0:q.call(l))??u(Ue,{color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0,size:"24",width:"2"},null)]}}),(I=l.default)==null?void 0:I.call(l)])])}),{blur:()=>{var r;(r=p.value)==null||r.some(T=>T.blur())},focus:()=>{var r;(r=p.value)==null||r[0].focus()},reset:Q,isFocused:c}}}),aa=K({__name:"OTPLoginForm",props:{email:{},disabled:{type:Boolean,default:!1},theme:{}},emits:["callback"],setup(e,{emit:w}){v(!0),ce();const g=w;de();const b=v(""),l=v({required:t=>!!t||"Required.",min:t=>t.length>=6||"Min 6 characters"}),m=v(""),c=(t=>{t.preventDefault(),(m.value="",!(l.value.required(b.value)!==!0||l.value.min(b.value)!==!0))&&g("callback",{mode:"validate",username:e.email,password:b.value})});return(t,d)=>(y(),V(fe,{onSubmit:me(c,["stop"]),disabled:e.disabled,class:J(`${e.theme?`theme-${e.theme}`:""}`)},{default:s(()=>[d[2]||(d[2]=C("h3",{class:"text-h6 mb-2"}," Please enter the one time password to verify your account ",-1)),C("p",null,"A code has been sent to "+N(e.email),1),u(P,null,{default:s(()=>[u(U,null,{default:s(()=>[u(ea,{disabled:e.disabled,length:"6",modelValue:b.value,"onUpdate:modelValue":d[0]||(d[0]=a=>b.value=a),rules:[l.value.required,l.value.min]},null,8,["disabled","modelValue","rules"])]),_:1})]),_:1}),u(P,null,{default:s(()=>[u(U,null,{default:s(()=>[u(j,{disabled:b.value.length!=6,type:"submit",color:"primary",variant:"flat",class:"w-100"},{default:s(()=>[...d[1]||(d[1]=[B(" Validate ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["disabled","class"]))}}),ta=H(aa,[["__scopeId","data-v-cef8d496"]]),na=async(e,w,g=!1)=>{const b=z(),{getAccessToken:l,storeAccessToken:m,storeRefreshToken:c}=te();let t="";try{t=await l()}catch{}return await $fetch(`${b.public.issuerUri}/connect/auth/internal`,{method:"post",body:JSON.stringify({oauth:e,access_token:t,internal:{username:w.username,password:w.password},new:g}),parseResponse:d=>{const a=JSON.parse(d);return a.AccessToken&&m(a.AccessToken),a.RefreshToken&&c(a.RefreshToken),{ErrorMessage:a.ErrorMessage||"",RedirectURI:a.RedirectURI||"",Existing:a.Existing||!1}}})},ee=async(e,w,g="",b=!1)=>{const l=z();return await $fetch(`${l.public.issuerUri}/connect/email/link`,{method:"post",body:JSON.stringify({oauth:e,internal:{username:w,password:g},new:b})})},sa=async(e,w,g=!1)=>{const b=z(),{storeAccessToken:l,storeRefreshToken:m}=te();return await $fetch(`${b.public.issuerUri}/connect/auth/otp`,{method:"post",body:JSON.stringify({oauth:e,internal:{username:w.username,password:w.password},new:g}),parseResponse:c=>{const t=JSON.parse(c);return t.AccessToken&&l(t.AccessToken),t.RefreshToken&&m(t.RefreshToken),{RedirectURI:t.RedirectURI||"",ErrorMessage:t.ErrorMessage||"",Existing:t.Existing||""}}})},la={class:"ma-auto",style:{"max-width":"450px"}},Ea=K({__name:"email",props:{mode:{default:"view"},requirePassword:{type:Boolean,default:!0},theme:{default:"shaded"},variant:{default:()=>O.COMBINED}},emits:["cancel","added"],setup(e,{emit:w}){const g=w,b=Ge(),l=v(""),m=v("email"),c=v(!1),t=ve(),d=v(!1),a=v(),L=n=>{switch(n.mode.toLocaleString()){case"add":return $(n);case"create":return x(n);case"link":return h(n.username);case"login":return p(n);case"register":return;case"validate":return k(n)}},$=async n=>{d.value=!1;const{token:f}=await ee(t,n.username,n.password,!0);l.value=n.username,a.value=f,m.value="otp_validate"},x=async n=>{d.value=!1;const{token:f}=await ee(t,n.username,n.password,!0);l.value=n.username,a.value=f,m.value="otp_create"},h=async n=>{d.value=!1;const{token:f}=await ee(t,n);l.value=n,a.value=f,m.value="otp_validate"},k=async n=>{c.value=!0;const{ErrorMessage:f,Existing:D,RedirectURI:M}=await sa(t,{username:n.username,password:`${a.value}:${n.password}`},m.value=="otp_create");if(e.variant!==O.ADD_CREDENTIAL&&M)try{const o=new URL(M).searchParams.get("error");if((o==null?void 0:o.toLowerCase())!="invalid_request"&&(o==null?void 0:o.toLowerCase())!="access_denied"){Y(M,{external:!0});return}}catch{}else if(e.variant===O.ADD_CREDENTIAL&&D&&!f){d.value=!1,c.value=!1,m.value="",g("added");return}d.value=!0,c.value=!1,m.value="email"},p=async n=>{c.value=!0,d.value=!1;const{RedirectURI:f}=await na(t,n);if(f){const M=new URL(f).searchParams.get("error");if((M==null?void 0:M.toLowerCase())=="invalid_request"){d.value=!0,c.value=!1;return}Y(f,{external:!0})}};return(n,f)=>(y(),F("div",la,[i(d)?(y(),V(P,{key:0},{default:s(()=>[u(U,null,{default:s(()=>[u(ze,{type:"error"},{default:s(()=>[u(_e,null,{default:s(()=>[...f[1]||(f[1]=[B("Login Failed",-1)])]),_:1}),f[2]||(f[2]=B(" There was problem with your login attempt. It may be the account doesn't exist or your password was incorrect. You may have also created your account using a Telegram login instead. ",-1))]),_:1})]),_:1})]),_:1})):S("",!0),u(P,null,{default:s(()=>[u(U,null,{default:s(()=>[i(m)=="email"?(y(),V(Qe,{key:0,disabled:i(c),"redirect-url":i(b).href,variant:e.variant,theme:e.theme,requirePassword:e.requirePassword,onCallback:L},null,8,["disabled","redirect-url","variant","theme","requirePassword"])):i(m)=="otp_create"||i(m)=="otp_validate"?(y(),V(ta,{key:1,disabled:i(c),email:i(l),theme:e.theme,onCallback:L},null,8,["disabled","email","theme"])):S("",!0)]),_:1})]),_:1}),e.mode=="view"?(y(),V(P,{key:1},{default:s(()=>[u(U,{class:"text-left"},{default:s(()=>[u(j,{color:"error",onClick:f[0]||(f[0]=D=>g("cancel")),class:"w-100","prepend-icon":"mdi:mdi-arrow-left-circle"},{default:s(()=>[...f[3]||(f[3]=[B(" Go Back ",-1)])]),_:1})]),_:1})]),_:1})):S("",!0)]))}}),oa={key:0,class:"ml-1"},ra=K({__name:"AuthButton",props:{appendIcon:{type:[String,Array,Function,Object],default:""},class:{default:""},credential:{},showUsername:{type:Boolean,default:!1},source:{default:"internal"}},setup(e){const w={amazon:{icon:"fa:fas fa-brands fa-amazon",label:A.buttonLoginAmazon,name:"Amazon"},email:{icon:"mdi:mdi-email",label:A.buttonLoginEmail,name:"Email"},facebook:{icon:"fa:fa fa-brands fa-facebook",label:A.buttonLoginFaceBook,name:"FaceBook"},google:{icon:"fa:fa fa-brands fa-google",label:A.buttonLoginGoogle,name:"Google"},internal:{icon:"mdi:mdi-email",label:A.buttonLoginEmail,name:"Email"},instagram:{icon:"fa:fa fa-brands fa-instagram",label:A.buttonLoginInstagram,name:"Instagram"},keycloak:{icon:"mdi:mdi-key-variant",label:A.buttonLoginKeycloak,name:"Keycloak"},microsoft:{icon:"fa:fa fa-brands fa-windows",label:A.buttonLoginMicrosoft,name:"Microsoft"},steam:{icon:"fa:fa fa-brands fa-steam",label:A.buttonLoginSteam,name:"Steam"},telegram:{icon:"fa:fa fa-brands fa-telegram",label:A.buttonLoginTelegram,name:"Telegram"},twitch:{icon:"fa:fa fa-brands fa-twitch",label:A.buttonLoginTwitch,name:"Twitch"},twitter:{icon:"fa:fa fa-brands fa-twitter",label:A.buttonLoginTwitter,name:"Twitter"}},g=v(w[e.source.toLowerCase()].label||""),b=v(w[e.source.toLowerCase()].icon||""),l=W(()=>{var m,c;if(e.source.toLowerCase()==="internal"||e.source.toLowerCase()==="email")return(m=e.credential)==null?void 0:m.Email;try{const t=JSON.parse(((c=e.credential)==null?void 0:c.Data)||"{}");switch(e.source.toLowerCase()){case"telegram":return`@${t.username||t.id}`;case"keycloak":return`${t.preferred_username}`}}catch{}return""});return(m,c)=>(y(),V(j,{"append-icon":e.appendIcon,"prepend-icon":b.value,class:J(`${e.source.toLowerCase()} ${e.class}`)},{default:s(()=>[B(N(g.value)+" ",1),e.showUsername&&e.credential?(y(),F("small",oa,"("+N(l.value)+")",1)):S("",!0)]),_:1},8,["append-icon","prepend-icon","class"]))}}),ge=H(ra,[["__scopeId","data-v-1c6ce024"]]),ie=async(e,w,g=!1)=>{const b=z(),{getAccessToken:l,storeAccessToken:m,storeRefreshToken:c}=te();let t="";try{t=await l()}catch{}return await $fetch(`${b.public.issuerUri}/connect/auth/telegram`,{method:"post",body:JSON.stringify({oauth:e,access_token:t,telegram:w,new:g}),parseResponse:d=>{const a=JSON.parse(d);return a.AccessToken&&m(a.AccessToken),a.RefreshToken&&c(a.RefreshToken),{RedirectURI:a.RedirectURI||"",ErrorMessage:a.ErrorMessage||"",Existing:a.Existing||!1}}})},ua={key:0,class:"my-2"},ia={key:1,class:"my-2"},ca={class:"my-2"},da={class:"my-2"},ma={class:"my-2"},fa=K({__name:"TelegramButton",props:{appendIcon:{type:[String,Array,Function,Object],default:""},class:{default:""},credential:{},showUsername:{type:Boolean,default:!1}},emits:["cancel","added"],setup(e,{emit:w}){const g=w,b=z();let l=v("");b.public.telegramBotId&&(l.value=b.public.telegramBotId);const m=ve(),c=v(!1),t=v(!1),d=v(0),a=v(),L=v(),$=async()=>{if(c.value=!1,!a.value)return;const{ErrorMessage:k,Existing:p,RedirectURI:n}=await ie(m,a.value,!0);p?k?(t.value=!0,d.value=1):g("added"):n&&Y(n,{external:!0})},x=()=>{{if(!window.Telegram||!window.Telegram.Login||!window.Telegram.Login.auth){console.error("Telegram not initialised");return}window.Telegram.Login.auth({bot_id:l.value,request_access:!0},k=>{k||console.error("Telegram Authorization Failed"),h(k)})}},h=async k=>{const{Existing:p,RedirectURI:n}=await ie(m,k,!1);if(n)try{const D=new URL(n).searchParams.get("error");D?D=="access_denied"?(c.value=!0,a.value=k):D=="invalid_request"?(t.value=!0,d.value=1):D=="server_error"&&(t.value=!0,d.value=2):Y(n,{external:!0})}catch(f){console.error(f),p&&g("added")}};return Ve(()=>{const k=document.createElement("script");k.async=!0,k.src="https://telegram.org/js/telegram-widget.js?22",L.value.appendChild(k)}),(k,p)=>(y(),F(ae,null,[$e(u(P,null,{default:s(()=>[u(U,{class:"text-center"},{default:s(()=>[C("div",{ref_key:"telegram",ref:L},null,512),u(ge,{"append-icon":e.appendIcon,credential:e.credential,"show-username":e.showUsername,source:"telegram",class:"d-flex justify-start w-100",onClick:x},null,8,["append-icon","credential","show-username"])]),_:1})]),_:1},512),[[De,i(l)]]),u(ue,{modelValue:i(t),"onUpdate:modelValue":p[0]||(p[0]=n=>oe(t)?t.value=n:null),"show-save-action":!1,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Error Attempting Telegram Login","hide-extension":!0,"remove-button-spacer":!0,"close-action-label":"Close",onClose:p[1]||(p[1]=n=>t.value=!1)},{default:s(()=>[i(d)===1?(y(),F("p",ua,N(i(A).messageCreateTelegramError1),1)):S("",!0),i(d)===2?(y(),F("p",ia,N(i(A).messageCreateTelegramError2),1)):S("",!0)]),_:1},8,["modelValue"]),u(ue,{modelValue:i(c),"onUpdate:modelValue":p[2]||(p[2]=n=>oe(c)?c.value=n:null),"show-save-action":!0,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Create new account","hide-extension":!0,"save-button-label":"Create Account",onSave:$,onClose:p[3]||(p[3]=n=>g("cancel"))},{default:s(()=>[C("p",ca,N(i(A).messageCreateTelegramAccount1),1),C("p",da,N(i(A).messageCreateTelegramAccount2),1),C("p",ma,N(i(A).messageCreateTelegramAccount3),1)]),_:1},8,["modelValue"])],64))}}),va=K({__name:"LoginButton",props:{appendIcon:{type:[String,Array,Function,Object],default:""},credential:{},params:{default:()=>({variant:O.COMBINED})},showUsername:{type:Boolean,default:!1},source:{default:"internal"},url:{default:""}},setup(e){return(w,g)=>e.source=="telegram"?(y(),V(fa,{key:0})):(y(),V(ge,{key:1,"append-icon":e.appendIcon,credential:e.credential,"show-username":e.showUsername,source:e.source,class:"d-flex justify-start w-100"},null,8,["append-icon","credential","show-username","source"]))}}),La=H(va,[["__scopeId","data-v-f907d1cc"]]),xa=async e=>{const w=z();try{const g=await $fetch(`${w.public.issuerUri}/connect/auth/urls?baseRedirect=${e}`,{method:"get",parseResponse:l=>l}),b=JSON.parse(g);return new Map(Object.entries(b.URLs))}catch(g){throw g}};export{ge as A,O as E,La as L,Ea as _,xa as u};
