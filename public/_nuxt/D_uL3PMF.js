import{T as h}from"./jc_BrVjT.js";import{h as T,e as y,r as p,P as C,aN as $,j as w,n as g,f as A,k as b,g as i,o as B,w as a,b as o,d as I,aa as N,aL as x,i as R}from"./3s1sx6wo.js";import{u as S}from"./CrLWP4D4.js";import{V as D,a as L,b as U,c as z}from"./4sMDSXH2.js";import{d as M}from"./BFI1zpWj.js";import{V as E,a as f}from"./BU9fDapT.js";import{V as O,a as j}from"./B7OmWiuf.js";import"./B5CZD0j7.js";import"./JhrxTPuU.js";import"./BMdyi6GD.js";import"./C9R-QpZI.js";import"./D6KsYbGk.js";import"./CGB_Pix4.js";import"./BDkkOniq.js";const P=()=>h.getInstance(),Y=async()=>{const u=T(),t=h.getInstance().getTokenByService("graze");return await $fetch(`${u.public.issuerUri}/api/access_check`,{method:"get",headers:{Authorization:`Bearer ${t==null?void 0:t.OAuthToken.AccessToken}`}})},re=y({__name:"admin",async setup(u){let r,t;const s=p(!1),{xs:k}=C(),c=$(),m=P(),d=p(!1),v=()=>{c.global.name.value=c.global.current.value.dark?"light":"dark"};try{[r,t]=w(()=>Y()),r=await r,t(),r&&(d.value=!0)}catch(n){const e=n;(e.message.includes("401")||e.message.includes("403"))&&(m.removeTokensByService("graze"),g(`/admin?error=access_denied&error_description=${encodeURIComponent("You are not authorised to access this service.")}`))}const V=async()=>{const n=R(),e=await S(),l=encodeURIComponent(`${window.location.origin}${n.resolve("/admin").href}`),_=`${e.EndSessionEndpoint}?client_id=internal&post_logout_redirect_uri=${l}`;m.removeTokensByService("graze"),g(_,{external:!0})};return(n,e)=>i(d)?(B(),A(j,{key:0},{default:a(()=>[o(D,{color:"primary","scroll-behavior":"collapse"},{default:a(()=>[o(L,null,{default:a(()=>e[2]||(e[2]=[I("Dashboard")])),_:1}),o(M),o(U,{onClick:e[0]||(e[0]=l=>s.value=!i(s))})]),_:1}),o(z,{modelValue:i(s),"onUpdate:modelValue":e[1]||(e[1]=l=>N(s)?s.value=l:null),location:i(k)?"top":"right",temporary:""},{default:a(()=>[o(E,null,{default:a(()=>[o(f,{"prepend-icon":"mdi:mdi-theme-light-dark",onClick:v,title:`${i(c).global.name.value=="dark"?"Light":"Dark"} Mode`},null,8,["title"]),o(f,{"prepend-icon":"mdi:mdi-logout",onClick:V,title:"Logout"})]),_:1})]),_:1},8,["modelValue","location"]),o(O,null,{default:a(()=>[x(n.$slots,"default")]),_:3})]),_:3})):b("",!0)}});export{re as default};
