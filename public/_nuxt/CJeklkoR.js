import{T as h}from"./Bgmjd9F8.js";import{h as T,e as y,M as p,k as C,aN as $,W as w,X as g,f as A,R as b,g as i,o as B,w as a,b as o,d as I,S as N,aL as R,V as S}from"./DU_nv6qb.js";import{u as x}from"./VBFc3691.js";import{V as D,a as L,b as M,c as U}from"./C96xZDyZ.js";import{d as z}from"./CglTRRRa.js";import{V as E,a as f}from"./CG0SyiXz.js";import{V as O,a as W}from"./DjasXb_v.js";import"./B5CZD0j7.js";import"./1d_XzYus.js";import"./C3fS7Lrv.js";import"./BFc9MCJK.js";import"./9qXTopoB.js";import"./tv55WV8d.js";import"./BKvEMHjZ.js";const X=()=>h.getInstance(),Y=async()=>{const u=T(),t=h.getInstance().getTokenByService("graze");return await $fetch(`${u.public.issuerUri}/api/access_check`,{method:"get",headers:{Authorization:`Bearer ${t==null?void 0:t.OAuthToken.AccessToken}`}})},re=y({__name:"admin",async setup(u){let r,t;const s=p(!1),{xs:k}=C(),c=$(),m=X(),d=p(!1),v=()=>{c.global.name.value=c.global.current.value.dark?"light":"dark"};try{[r,t]=w(()=>Y()),r=await r,t(),r&&(d.value=!0)}catch(n){const e=n;(e.message.includes("401")||e.message.includes("403"))&&(m.removeTokensByService("graze"),g(`/admin?error=access_denied&error_description=${encodeURIComponent("You are not authorised to access this service.")}`))}const V=async()=>{const n=S(),e=await x(),l=encodeURIComponent(`${window.location.origin}${n.resolve("/admin").href}`),_=`${e.EndSessionEndpoint}?client_id=internal&post_logout_redirect_uri=${l}`;m.removeTokensByService("graze"),g(_,{external:!0})};return(n,e)=>i(d)?(B(),A(W,{key:0},{default:a(()=>[o(D,{color:"primary","scroll-behavior":"collapse"},{default:a(()=>[o(L,null,{default:a(()=>e[2]||(e[2]=[I("Dashboard")])),_:1}),o(z),o(M,{onClick:e[0]||(e[0]=l=>s.value=!i(s))})]),_:1}),o(U,{modelValue:i(s),"onUpdate:modelValue":e[1]||(e[1]=l=>N(s)?s.value=l:null),location:i(k)?"top":"right",temporary:""},{default:a(()=>[o(E,null,{default:a(()=>[o(f,{"prepend-icon":"mdi:mdi-theme-light-dark",onClick:v,title:`${i(c).global.name.value=="dark"?"Light":"Dark"} Mode`},null,8,["title"]),o(f,{"prepend-icon":"mdi:mdi-logout",onClick:V,title:"Logout"})]),_:1})]),_:1},8,["modelValue","location"]),o(O,null,{default:a(()=>[R(n.$slots,"default")]),_:3})]),_:3})):b("",!0)}});export{re as default};
